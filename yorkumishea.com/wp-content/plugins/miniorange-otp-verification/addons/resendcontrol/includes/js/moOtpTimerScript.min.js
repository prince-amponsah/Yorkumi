"undefined"==typeof $mo&&($mo=jQuery),activeTimers=[];let flag=1,isAjaxButtonInitialized=!1;var isformFound=!1,isPopUpLoaded=!1;const buttonSelectors=['input[id*="mo_wc_send_otp"]','input[id*="miniorange_otp_token_submit"]','input[id*="mo_send_otp_"]','input[id*="mo_otp_token_submit"]','input[id*="mo_tutor_lms_login_send_otp"]','input[id*="mo_um_send_otp_pass"]','input[id*="mo_um_accup_button"]','input[id*="mo_tutor_lms_send_otp"]','input[id*="mo_tutor_lms_student_send_otp"]','input[id*="mo_um_getotp_button"]','input[id*="send_otp"]','input[id*="mo_login_register_with_phone"]','a[id*="miniorange_otp_token_submit"]','button[id*="miniorange_otp_token_submit"]','button[id*="mo_send_otp_"]','input[id*="mo_um_accup_button"]'];function waitForAnyElement(t,e){const o=setInterval((()=>{const i=t.find((t=>$mo(t).length>0));i&&(clearInterval(o),e(i))}),100);setTimeout((()=>{clearInterval(o)}),3e3)}function checkUserBlocked(){return new Promise(((t,e)=>{$mo.ajax({url:moOtpTimerScript.siteURL,type:"POST",data:{action:"check_blocked"},success:function(e){e.blocked?t({isBlocked:!0,remaining_time:e.remaining_time}):t({isBlocked:!1,remaining_time:null})},error:function(){e({isBlocked:!1,remaining_time:null})}})}))}function ajaxButtonClicked(){const t='div[id*="mo_message"]',e=moOtpTimerScript.limit_otp_sent_message;buttonSelectors.forEach((function(o){$mo(o).each((function(){const i=$mo(this);$mo(o).length>0&&flag&&(flag=0,i.on("click",(function(){$mo(o).hide();const n=setInterval((function(){if(0===$mo.active){clearInterval(n);const c=$mo(t),m=c.attr("style"),a=c.attr("class");var r=m.includes("red")||m.includes("#ffefef")||m.includes("background-color: rgb(255, 239, 239)")||m.includes("background-color: rgb(237, 165, 142)");if(void 0!==a)r=a.includes("woocommerce-error");if(r)$mo(o).show(),clearAllIntervals();else{let o="<div class='moloader'></div>";c.empty().append(o),checkUserBlocked().then((function(o){const n=o.isBlocked?o.remaining_time:moOtpTimerScript.otpControlTimerTime,r=moOtpTimerScript.user_blocked_message;var c=o.isBlocked?r:e;clearAllIntervals(),buttonTimer(n,i,document.querySelector(t),c,o.isBlocked)})).catch((function(t){}))}}}),10)})))}))}))}function unblockUser(){return $mo.ajax({url:moOtpTimerScript.siteURL,type:"POST",data:{action:"unblock_user"}})}function buttonTimer(t,e,o,i,n){o&&$mo(o).show(),startTimer(t,o,e,i,n)}function startTimer(t,e,o,i,n){let r=t;window.sentTimerFunction=setInterval((()=>{const t=String(Math.floor(r/60)).padStart(2,"0"),c=String(r%60).padStart(2,"0"),m=i.replace("{minutes}",t).replace("{seconds}",c);if(window.verifyOTPmessage&&e){var a=moOtpTimerScript.error_otp_verify_message.replace("{minutes}",t).replace("{seconds}",c);e.innerHTML=window.verifyOTPmessage+"<br>"+a}else e&&(e.textContent=m);r<=1&&unblockUser().fail((t=>{})),r<=0&&(clearInterval(sentTimerFunction),window.verifyOTPmessage&&delete window.verifyOTPmessage,$mo(e).hide(),$mo(o).is("#mo_tutor_lms_login_send_otp")||(n?$mo(o).show():$mo(o).is("#mo_login_register_with_phone")||$mo(o).show()),$mo(o).attr("data-timer-active","false")),r--}),1e3),activeTimers.push(sentTimerFunction)}function clearAllIntervals(){activeTimers.forEach((function(t){clearInterval(t)})),activeTimers=[]}function mo_pop_up_limit_otp(){isPopUpLoaded=!0;const t=$mo("a[id*='mo_otp_verification_resend']"),e="a[id*='mo_otp_verification_resend']";$mo("<p id='otpTimer' hidden style='float:right;margin-top:5px'></p>").insertAfter(t),['a[id*="mo_otp_verification_resend"]','button[id*="miniorange_wc_popup_send_otp_token"]','a[id*="miniorange_wc_popup_send_otp_token"]','input[id*="miniorange_wc_popup_send_otp_token"]'].forEach((function(o){'input[id*="miniorange_wc_popup_send_otp_token"]'===o||'a[id*="miniorange_wc_popup_send_otp_token"]'===o?$mo(document).on("click",o,(function(){$mo(document).off("ajaxComplete").on("ajaxComplete",(function(o,i,n){if(n.url.includes("?option=miniorange-woocommerce-checkout"))try{let o=JSON.parse(i.responseText);200===i.status&&"success"===o.result&&($mo(e).hide(),popupButtonClick(e,t))}catch(t){console.error("Error parsing AJAX response:",t)}}))})):$mo(document).on("click",o,(function(){$mo(e).hide(),waitForOTPCall((()=>{popupButtonClick(e,t)}))}))}))}function popupButtonClick(t,e){checkUserBlocked().then((function(o){const i=o.isBlocked?o.remaining_time:moOtpTimerScript.otpControlTimerTime;e.length>0?PopUpbuttonTimer(t,i):$mo(t).show()}))}function PopUpbuttonTimer(t,e){display=document.querySelector("#otpTimer"),$mo(display).show(),PopUpstartTimer(e,display,t)}function PopUpstartTimer(t,e,o){var i,n,r=t,c=setInterval((function(){i=parseInt(r/60,10),n=parseInt(r%60,10),i=i<10?"0"+i:i,n=n<10?"0"+n:n,e.textContent=i+":"+n+" minutes.",r<1&&($mo(e).hide(),$mo(o).show(),unblockUser().fail((t=>{})),clearInterval(c)),--r<0&&(r=t)}),1e3);activeTimers.push(c)}function waitForOTPCall(t){const e=setInterval((()=>{void 0!==window.mo_wc_otp_initialized&&(window.mo_wc_otp_initialized&&t(),delete window.mo_wc_otp_initialized,clearInterval(e))}),100);setTimeout((()=>{clearInterval(e)}),2e4)}$mo(document).ready((function(){setTimeout((function(){if(!$mo("#mo-time-remain").length>0&&!$mo("#mo_site_otp_form").length>0){const t={".ninja-forms-field":"undefined"!=typeof mo_ninja_field?mo_ninja_field:null,".woocommerce-EditAccountForm":"phone"===("undefined"!=typeof mowc_otp_type?mowc_otp_type:null)?'input[id="billing_phone"]':'input[id="account_email"]',".um-account-tab":'input[id="user_email"]',".um-profile-body":'input[id*="mobile_number"]'};let e=!1,o=!1;Object.entries(t).forEach((([t,e])=>{$mo(t).length>0&&!isAjaxButtonInitialized&&(o=!0,$mo(e).on("keyup input",(function(t){isAjaxButtonInitialized||(isAjaxButtonInitialized=!0,waitForAnyElement(buttonSelectors,(()=>{ajaxButtonClicked()})))})))})),o||(e?ajaxButtonClicked():(waitForAnyElement(buttonSelectors,(()=>{ajaxButtonClicked()})),e=!0))}else clearAllIntervals();setTimeout((()=>{$mo("#mo_site_otp_form").length>0&&!isPopUpLoaded&&($mo("#send_otp").length>0?($mo("#validate_otp").on("click",(function(){clearAllIntervals()})),ajaxButtonClicked()):mo_pop_up_limit_otp())}),2e3)}),100)}));